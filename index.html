<!doctype html>
<html lang="id">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PT. Jaya Kencana Safety System</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100%;
            color: white;
        }

        html {
            height: 100%;
        }

        .container {
            min-height: 100%;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex: 1;
            padding: 20px;
        }

        /* Login Styles */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 80%;
            padding: 20px;
        }

        .login-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .login-title {
            text-align: center;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00d4ff, #9c27b0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-subtitle {
            text-align: center;
            color: #b0b0b0;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .login-tabs {
            display: flex;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 4px;
        }

        .login-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .login-tab.active {
            background: linear-gradient(45deg, #00d4ff, #9c27b0);
            color: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #e0e0e0;
        }

        .form-input {
            width: 100%;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.2);
        }

        .form-input::placeholder {
            color: #888;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #9c27b0, #673ab7);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(156, 39, 176, 0.4);
        }

        /* Dashboard Styles */
        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: block;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .company-title {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00d4ff, #9c27b0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .user-subtitle {
            font-size: 18px;
            color: #b0b0b0;
            font-weight: 400;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }

        .nav-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        .nav-icon {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
        }

        .nav-title {
            font-size: 18px;
            font-weight: 600;
            color: white;
        }

        /* Form Styles */
        .form-section {
            display: none;
            max-width: 800px;
            margin: 0 auto;
        }

        .form-section.active {
            display: block;
        }

        .section-header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #00d4ff, #9c27b0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .form-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .item-section {
            border-top: 2px solid rgba(0, 212, 255, 0.5);
            padding-top: 20px;
            margin-top: 30px;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .item-title {
            font-size: 24px;
            font-weight: 600;
            color: #00d4ff;
        }

        .add-btn {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-left: 10px;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
        }

        .submit-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(45deg, #9c27b0, #673ab7);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 30px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(156, 39, 176, 0.4);
        }

        .item-group {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #00d4ff;
        }

        .remove-item {
            background: #ff4757;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            color: white;
            cursor: pointer;
            font-size: 12px;
            float: right;
        }

        /* History Styles */
        .history-table {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 20px;
        }

        .table-header {
            background: rgba(0, 212, 255, 0.2);
            padding: 15px;
            font-weight: 600;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 100px;
            gap: 15px;
        }

        .table-row {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 100px;
            gap: 15px;
            align-items: center;
        }

        .table-row:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .edit-btn {
            background: #ffa502;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            color: white;
            cursor: pointer;
            font-size: 12px;
        }

        .delete-btn {
            background: #ff4757;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            color: white;
            cursor: pointer;
            font-size: 12px;
            margin-left: 5px;
        }

        /* Footer Styles */
        .footer {
            background: #004A99;
            padding: 40px 20px 20px;
            margin-top: auto;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 20px;
            color: white;
        }

        .footer-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        .footer-item {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
        }

        .footer-icon {
            width: 20px;
            height: 20px;
            fill: white;
        }

        .social-icons {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .social-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #ffa502, #ff6348);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: white;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .social-icon:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 165, 2, 0.4);
        }

        .copyright {
            text-align: center;
            color: #b0b0b0;
            font-size: 14px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #00d4ff;
        }

        .loading.show {
            display: block;
        }

        @media (max-width: 768px) {
            .company-title {
                font-size: 32px;
            }
            
            .nav-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .table-header, .table-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .item-header {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container"><!-- Login Section -->
   <div id="loginSection" class="main-content">
    <div class="login-container">
     <div class="login-card">
      <h1 class="login-title" id="companyTitle">PT. JAYA KENCANA</h1>
      <p class="login-subtitle">Safety Management System</p>
      <div class="login-tabs">
       <div class="login-tab active" onclick="switchTab('admin')">
        Admin
       </div>
       <div class="login-tab" onclick="switchTab('user')">
        User
       </div>
      </div>
      <form id="loginForm" onsubmit="handleLogin(event)">
       <div class="form-group"><label for="username" class="form-label">Username</label> <input type="text" id="username" class="form-input" placeholder="Masukkan username" required>
       </div>
       <div class="form-group"><label for="password" class="form-label">Password</label> <input type="password" id="password" class="form-input" placeholder="Masukkan password" required>
       </div><button type="submit" class="login-btn">Login</button>
      </form>
     </div>
    </div>
   </div><!-- Dashboard Section -->
   <div id="dashboardSection" class="main-content dashboard">
    <div class="dashboard-header">
     <h1 class="company-title" id="dashboardCompanyTitle">PT. JAYA KENCANA</h1>
     <p class="user-subtitle" id="userWelcome">Selamat datang, User</p><button class="back-btn" onclick="logout()">Logout</button>
    </div>
    <div class="nav-grid">
     <div class="nav-card" onclick="showSection('escalator')"><span class="nav-icon">🔧</span>
      <div class="nav-title">
       Safety Eskalator
      </div>
     </div>
     <div class="nav-card" onclick="showSection('elevator')"><span class="nav-icon">🏢</span>
      <div class="nav-title">
       Safety Elevator
      </div>
     </div>
     <div class="nav-card" onclick="showSection('realization')"><span class="nav-icon">📊</span>
      <div class="nav-title">
       Realisasi
      </div>
     </div>
     <div class="nav-card" onclick="showSection('history')"><span class="nav-icon">📋</span>
      <div class="nav-title">
       History
      </div>
     </div>
    </div>
   </div><!-- Escalator Form Section -->
   <div id="escalatorSection" class="main-content form-section"><button class="back-btn" onclick="showDashboard()">← Kembali ke Dashboard</button>
    <div class="section-header">
     <h2 class="section-title">Safety Eskalator</h2>
    </div>
    <form id="escalatorForm" onsubmit="handleSubmit(event, 'escalator')">
     <div class="form-card">
      <div class="form-row">
       <div class="form-group"><label for="buildingName" class="form-label">Nama Gedung/Proyek</label> <select id="buildingName" class="form-input" required> <option value="">Pilih Gedung</option> <option value="Gedung A">Gedung A</option> <option value="Gedung B">Gedung B</option> <option value="Mall Central">Mall Central</option> <option value="Office Tower">Office Tower</option> </select>
       </div>
       <div class="form-group"><label for="technicianName" class="form-label">Nama Teknisi</label> <input type="text" id="technicianName" class="form-input" placeholder="Masukkan nama teknisi" required>
       </div>
       <div class="form-group"><label for="inspectionDate" class="form-label">Tanggal</label> <input type="date" id="inspectionDate" class="form-input" required>
       </div>
      </div>
     </div>
     <div class="item-section">
      <div class="item-header">
       <h3 class="item-title">ITEM</h3>
       <div><button type="button" class="add-btn" onclick="addUnit()">+ Tambah Unit</button>
       </div>
      </div>
      <div id="unitsContainer">
       <div class="unit-group">
        <div class="form-card">
         <div class="form-row">
          <div class="form-group"><label class="form-label">Unit</label> <input type="text" class="form-input unit-input" placeholder="Masukkan unit" required>
          </div>
          <div class="form-group"><label class="form-label">MFG</label> <input type="text" class="form-input mfg-input" placeholder="Masukkan MFG" required>
          </div>
          <div class="form-group"><label class="form-label">Type</label> <input type="text" class="form-input type-input" placeholder="Masukkan type" required>
          </div>
         </div>
         <div class="item-header">
          <h4 style="color: #00d4ff; margin: 0;">Items</h4><button type="button" class="add-btn" onclick="addItem(this)">+ Tambah Item</button>
         </div>
         <div class="items-container">
          <div class="item-group">
           <div class="form-row">
            <div class="form-group"><label class="form-label">Item Sparepart</label> <input type="text" class="form-input" placeholder="Masukkan item sparepart" required>
            </div>
            <div class="form-group"><label class="form-label">Kondisi</label> <input type="text" class="form-input" placeholder="Masukkan kondisi" required>
            </div>
            <div class="form-group"><label class="form-label">Jumlah</label> <input type="number" class="form-input" placeholder="Masukkan jumlah" required>
            </div>
            <div class="form-group"><label class="form-label">Remarks</label> <input type="text" class="form-input" placeholder="Masukkan remarks">
            </div>
            <div class="form-group"><label class="form-label">Prioritas</label> <select class="form-input" required> <option value="">Pilih Prioritas</option> <option value="High">High</option> <option value="Medium">Medium</option> <option value="Low">Low</option> </select>
            </div>
            <div class="form-group"><label class="form-label">Foto Part (Max 2)</label> <input type="file" class="form-input" accept="image/*" multiple> <small style="color: #b0b0b0;">Maksimal 2 foto</small>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div><button type="submit" class="submit-btn">Submit</button>
    </form>
   </div><!-- Elevator Form Section -->
   <div id="elevatorSection" class="main-content form-section"><button class="back-btn" onclick="showDashboard()">← Kembali ke Dashboard</button>
    <div class="section-header">
     <h2 class="section-title">Safety Elevator</h2>
    </div>
    <form id="elevatorForm" onsubmit="handleSubmit(event, 'elevator')">
     <div class="form-card">
      <div class="form-row">
       <div class="form-group"><label for="elevatorBuildingName" class="form-label">Nama Gedung/Proyek</label> <select id="elevatorBuildingName" class="form-input" required> <option value="">Pilih Gedung</option> <option value="Gedung A">Gedung A</option> <option value="Gedung B">Gedung B</option> <option value="Mall Central">Mall Central</option> <option value="Office Tower">Office Tower</option> </select>
       </div>
       <div class="form-group"><label for="elevatorTechnicianName" class="form-label">Nama Teknisi</label> <input type="text" id="elevatorTechnicianName" class="form-input" placeholder="Masukkan nama teknisi" required>
       </div>
       <div class="form-group"><label for="elevatorInspectionDate" class="form-label">Tanggal</label> <input type="date" id="elevatorInspectionDate" class="form-input" required>
       </div>
      </div>
     </div>
     <div class="item-section">
      <div class="item-header">
       <h3 class="item-title">ITEM</h3>
       <div><button type="button" class="add-btn" onclick="addElevatorUnit()">+ Tambah Unit</button>
       </div>
      </div>
      <div id="elevatorUnitsContainer">
       <div class="unit-group">
        <div class="form-card">
         <div class="form-row">
          <div class="form-group"><label class="form-label">Unit</label> <input type="text" class="form-input unit-input" placeholder="Masukkan unit" required>
          </div>
          <div class="form-group"><label class="form-label">MFG</label> <input type="text" class="form-input mfg-input" placeholder="Masukkan MFG" required>
          </div>
          <div class="form-group"><label class="form-label">Type</label> <input type="text" class="form-input type-input" placeholder="Masukkan type" required>
          </div>
         </div>
         <div class="item-header">
          <h4 style="color: #00d4ff; margin: 0;">Items</h4><button type="button" class="add-btn" onclick="addItem(this)">+ Tambah Item</button>
         </div>
         <div class="items-container">
          <div class="item-group">
           <div class="form-row">
            <div class="form-group"><label class="form-label">Item Sparepart</label> <input type="text" class="form-input" placeholder="Masukkan item sparepart" required>
            </div>
            <div class="form-group"><label class="form-label">Kondisi</label> <input type="text" class="form-input" placeholder="Masukkan kondisi" required>
            </div>
            <div class="form-group"><label class="form-label">Jumlah</label> <input type="number" class="form-input" placeholder="Masukkan jumlah" required>
            </div>
            <div class="form-group"><label class="form-label">Remarks</label> <input type="text" class="form-input" placeholder="Masukkan remarks">
            </div>
            <div class="form-group"><label class="form-label">Prioritas</label> <select class="form-input" required> <option value="">Pilih Prioritas</option> <option value="High">High</option> <option value="Medium">Medium</option> <option value="Low">Low</option> </select>
            </div>
            <div class="form-group"><label class="form-label">Foto Part (Max 2)</label> <input type="file" class="form-input" accept="image/*" multiple> <small style="color: #b0b0b0;">Maksimal 2 foto</small>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div><button type="submit" class="submit-btn">Submit</button>
    </form>
   </div><!-- Realization Section -->
   <div id="realizationSection" class="main-content form-section"><button class="back-btn" onclick="showDashboard()">← Kembali ke Dashboard</button>
    <div class="section-header">
     <h2 class="section-title">Realisasi</h2>
     <p style="color: #b0b0b0; margin-top: 10px;">Fitur realisasi akan segera tersedia</p>
    </div>
   </div><!-- History Section -->
   <div id="historySection" class="main-content form-section"><button class="back-btn" onclick="showDashboard()">← Kembali ke Dashboard</button>
    <div class="section-header">
     <h2 class="section-title">History Data</h2>
    </div>
    <div class="loading" id="historyLoading">
     <p>Memuat data...</p>
    </div>
    <div id="historyContent">
     <div class="history-table">
      <div class="table-header">
       <div>
        Tipe
       </div>
       <div>
        Gedung
       </div>
       <div>
        Teknisi
       </div>
       <div>
        Tanggal
       </div>
       <div>
        Aksi
       </div>
      </div>
      <div id="historyTableBody"><!-- Data will be populated here -->
      </div>
     </div>
    </div>
   </div><!-- Footer -->
   <footer class="footer">
    <div class="footer-content">
     <h3 class="footer-title">Jakarta</h3>
     <div class="footer-info">
      <div class="footer-item">
       <svg class="footer-icon" viewbox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
       </svg><span id="footerAddress">Jl. Salemba Raya No.61 Jakarta - Indonesia 10440</span>
      </div>
      <div class="footer-item">
       <svg class="footer-icon" viewbox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z" />
       </svg><span id="footerPhone1">(021) 390 8501</span>
      </div>
      <div class="footer-item">
       <svg class="footer-icon" viewbox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z" />
       </svg><span id="footerPhone2">(021) 390 8510</span>
      </div>
      <div class="footer-item">
       <svg class="footer-icon" viewbox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" />
       </svg><span id="footerEmail">info@jayakencana.com</span>
      </div>
     </div>
     <div class="social-icons"><a href="https://www.instagram.com/pt.jayakencana/" target="_blank" rel="noopener noreferrer" class="social-icon">📷</a> <a href="https://www.youtube.com/@ptjayakencana6459" target="_blank" rel="noopener noreferrer" class="social-icon">📺</a> <a href="https://www.facebook.com/jaya.kencana.790693" target="_blank" rel="noopener noreferrer" class="social-icon">📘</a>
     </div>
     <div class="copyright">
      Copyright 2025 PT. Jaya Kencana
     </div>
    </div>
   </footer>
  </div>
  <script>
        let currentUser = null;
        let currentUserType = 'admin';
        let allData = [];

        const defaultConfig = {
            company_name: "PT. JAYA KENCANA",
            address: "Jl. Salemba Raya No.61 Jakarta - Indonesia 10440",
            phone1: "(021) 390 8501",
            phone2: "(021) 390 8510",
            email: "info@jayakencana.com"
        };

        const dataHandler = {
            onDataChanged(data) {
                allData = data;
                if (document.getElementById('historySection').classList.contains('active')) {
                    renderHistory();
                }
            }
        };

        async function initializeApp() {
            if (window.dataSdk) {
                const initResult = await window.dataSdk.init(dataHandler);
                if (!initResult.isOk) {
                    console.error("Failed to initialize data SDK");
                }
            }

            if (window.elementSdk) {
                await window.elementSdk.init({
                    defaultConfig,
                    onConfigChange: async (config) => {
                        document.getElementById('companyTitle').textContent = config.company_name || defaultConfig.company_name;
                        document.getElementById('dashboardCompanyTitle').textContent = config.company_name || defaultConfig.company_name;
                        document.getElementById('footerAddress').textContent = config.address || defaultConfig.address;
                        document.getElementById('footerPhone1').textContent = config.phone1 || defaultConfig.phone1;
                        document.getElementById('footerPhone2').textContent = config.phone2 || defaultConfig.phone2;
                        document.getElementById('footerEmail').textContent = config.email || defaultConfig.email;
                    },
                    mapToCapabilities: (config) => ({
                        recolorables: [],
                        borderables: [],
                        fontEditable: undefined,
                        fontSizeable: undefined
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ["company_name", config.company_name || defaultConfig.company_name],
                        ["address", config.address || defaultConfig.address],
                        ["phone1", config.phone1 || defaultConfig.phone1],
                        ["phone2", config.phone2 || defaultConfig.phone2],
                        ["email", config.email || defaultConfig.email]
                    ])
                });
            }
        }

        function switchTab(type) {
            currentUserType = type;
            const tabs = document.querySelectorAll('.login-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
        }

        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Simple validation - in real app, this would be server-side
            if (username && password) {
                currentUser = username;
                document.getElementById('userWelcome').textContent = `Selamat datang, ${username}`;
                showDashboard();
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('loginForm').reset();
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('dashboardSection').classList.remove('active');
            hideAllSections();
        }

        function showDashboard() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('dashboardSection').classList.add('active');
            hideAllSections();
        }

        function hideAllSections() {
            const sections = ['escalatorSection', 'elevatorSection', 'realizationSection', 'historySection'];
            sections.forEach(section => {
                document.getElementById(section).classList.remove('active');
            });
        }

        function showSection(sectionName) {
            hideAllSections();
            document.getElementById('dashboardSection').classList.remove('active');
            
            if (sectionName === 'history') {
                document.getElementById('historySection').classList.add('active');
                loadHistory();
            } else if (sectionName === 'realization') {
                document.getElementById('realizationSection').classList.add('active');
            } else {
                document.getElementById(sectionName + 'Section').classList.add('active');
            }
        }

        function addUnit() {
            const container = document.getElementById('unitsContainer');
            const unitGroup = container.querySelector('.unit-group').cloneNode(true);
            
            // Clear all inputs
            const inputs = unitGroup.querySelectorAll('input, select');
            inputs.forEach(input => {
                if (input.type === 'file') {
                    input.value = '';
                } else {
                    input.value = '';
                }
            });
            
            // Add remove button
            const removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'remove-item';
            removeBtn.textContent = 'Hapus Unit';
            removeBtn.onclick = function() { this.closest('.unit-group').remove(); };
            unitGroup.querySelector('.form-card').appendChild(removeBtn);
            
            container.appendChild(unitGroup);
        }

        function addElevatorUnit() {
            const container = document.getElementById('elevatorUnitsContainer');
            const unitGroup = container.querySelector('.unit-group').cloneNode(true);
            
            // Clear all inputs
            const inputs = unitGroup.querySelectorAll('input, select');
            inputs.forEach(input => {
                if (input.type === 'file') {
                    input.value = '';
                } else {
                    input.value = '';
                }
            });
            
            // Add remove button
            const removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'remove-item';
            removeBtn.textContent = 'Hapus Unit';
            removeBtn.onclick = function() { this.closest('.unit-group').remove(); };
            unitGroup.querySelector('.form-card').appendChild(removeBtn);
            
            container.appendChild(unitGroup);
        }

        function addItem(button) {
            const itemsContainer = button.closest('.form-card').querySelector('.items-container');
            const itemGroup = itemsContainer.querySelector('.item-group').cloneNode(true);
            
            // Clear all inputs
            const inputs = itemGroup.querySelectorAll('input, select');
            inputs.forEach(input => {
                if (input.type === 'file') {
                    input.value = '';
                } else {
                    input.value = '';
                }
            });
            
            // Add remove button
            const removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'remove-item';
            removeBtn.textContent = 'Hapus';
            removeBtn.onclick = function() { this.closest('.item-group').remove(); };
            itemGroup.appendChild(removeBtn);
            
            itemsContainer.appendChild(itemGroup);
        }

        async function handleSubmit(event, type) {
            event.preventDefault();
            
            if (!window.dataSdk) {
                return;
            }

            const form = event.target;
            const submitBtn = form.querySelector('.submit-btn');
            
            // Show loading state
            submitBtn.disabled = true;
            submitBtn.textContent = 'Menyimpan...';
            
            try {
                if (allData.length >= 999) {
                    const errorDiv = document.createElement('div');
                    errorDiv.style.cssText = 'background: #ff4757; color: white; padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center;';
                    errorDiv.textContent = 'Batas maksimum 999 data telah tercapai. Silakan hapus beberapa data terlebih dahulu.';
                    form.insertBefore(errorDiv, submitBtn);
                    
                    setTimeout(() => errorDiv.remove(), 5000);
                    return;
                }

                const formData = new FormData(form);
                const buildingName = type === 'escalator' ? 
                    document.getElementById('buildingName').value : 
                    document.getElementById('elevatorBuildingName').value;
                const technicianName = type === 'escalator' ? 
                    document.getElementById('technicianName').value : 
                    document.getElementById('elevatorTechnicianName').value;
                const inspectionDate = type === 'escalator' ? 
                    document.getElementById('inspectionDate').value : 
                    document.getElementById('elevatorInspectionDate').value;

                // Collect units data
                const container = type === 'escalator' ? 
                    document.getElementById('unitsContainer') : 
                    document.getElementById('elevatorUnitsContainer');
                const unitGroups = container.querySelectorAll('.unit-group');
                
                let unitsData = [];
                unitGroups.forEach(unitGroup => {
                    const unit = unitGroup.querySelector('.unit-input').value;
                    const mfg = unitGroup.querySelector('.mfg-input').value;
                    const typeValue = unitGroup.querySelector('.type-input').value;
                    
                    const items = [];
                    const itemGroups = unitGroup.querySelectorAll('.item-group');
                    itemGroups.forEach(itemGroup => {
                        const inputs = itemGroup.querySelectorAll('input, select');
                        if (inputs.length >= 5) {
                            items.push({
                                sparepart: inputs[0].value,
                                condition: inputs[1].value,
                                quantity: inputs[2].value,
                                remarks: inputs[3].value,
                                priority: inputs[4].value
                            });
                        }
                    });
                    
                    unitsData.push({
                        unit: unit,
                        mfg: mfg,
                        type: typeValue,
                        items: items
                    });
                });

                const record = {
                    id: Date.now().toString(),
                    type: type,
                    building_name: buildingName,
                    technician_name: technicianName,
                    date: inspectionDate,
                    units: JSON.stringify(unitsData),
                    created_at: new Date().toISOString(),
                    user_type: currentUserType
                };

                const result = await window.dataSdk.create(record);
                
                if (result.isOk) {
                    // Show success message
                    const successDiv = document.createElement('div');
                    successDiv.style.cssText = 'background: #2ed573; color: white; padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center;';
                    successDiv.textContent = 'Data berhasil disimpan!';
                    form.insertBefore(successDiv, submitBtn);
                    
                    // Reset form
                    form.reset();
                    
                    // Remove success message after 3 seconds
                    setTimeout(() => {
                        successDiv.remove();
                        showDashboard();
                    }, 2000);
                } else {
                    // Show error message
                    const errorDiv = document.createElement('div');
                    errorDiv.style.cssText = 'background: #ff4757; color: white; padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center;';
                    errorDiv.textContent = 'Gagal menyimpan data. Silakan coba lagi.';
                    form.insertBefore(errorDiv, submitBtn);
                    
                    setTimeout(() => errorDiv.remove(), 5000);
                }
            } catch (error) {
                console.error('Error submitting form:', error);
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'background: #ff4757; color: white; padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center;';
                errorDiv.textContent = 'Terjadi kesalahan. Silakan coba lagi.';
                form.insertBefore(errorDiv, submitBtn);
                
                setTimeout(() => errorDiv.remove(), 5000);
            } finally {
                // Reset button state
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit';
            }
        }

        async function loadHistory() {
            const loading = document.getElementById('historyLoading');
            const content = document.getElementById('historyContent');
            
            loading.classList.add('show');
            content.style.display = 'none';
            
            // Simulate loading delay
            setTimeout(() => {
                renderHistory();
                loading.classList.remove('show');
                content.style.display = 'block';
            }, 1000);
        }

        function renderHistory() {
            const tbody = document.getElementById('historyTableBody');
            tbody.innerHTML = '';
            
            if (allData.length === 0) {
                tbody.innerHTML = '<div class="table-row"><div colspan="5" style="text-align: center; color: #b0b0b0;">Belum ada data</div></div>';
                return;
            }
            
            allData.forEach(record => {
                const row = document.createElement('div');
                row.className = 'table-row';
                row.innerHTML = `
                    <div>${record.type === 'escalator' ? 'Eskalator' : 'Elevator'}</div>
                    <div>${record.building_name}</div>
                    <div>${record.technician_name}</div>
                    <div>${new Date(record.date).toLocaleDateString('id-ID')}</div>
                    <div>
                        ${currentUserType === 'admin' ? `
                            <button class="edit-btn" onclick="editRecord('${record.__backendId}')">Edit</button>
                            <button class="delete-btn" onclick="deleteRecord('${record.__backendId}')">Hapus</button>
                        ` : ''}
                    </div>
                `;
                tbody.appendChild(row);
            });
        }

        async function deleteRecord(backendId) {
            if (!window.dataSdk) return;
            
            const record = allData.find(r => r.__backendId === backendId);
            if (!record) return;
            
            // Create inline confirmation
            const confirmDiv = document.createElement('div');
            confirmDiv.style.cssText = 'background: rgba(255, 71, 87, 0.1); border: 1px solid #ff4757; border-radius: 10px; padding: 20px; margin: 20px 0; text-align: center;';
            confirmDiv.innerHTML = `
                <p style="margin-bottom: 15px; color: white;">Yakin ingin menghapus data ini?</p>
                <button onclick="confirmDelete('${backendId}')" style="background: #ff4757; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin-right: 10px; cursor: pointer;">Ya, Hapus</button>
                <button onclick="this.closest('div').remove()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Batal</button>
            `;
            
            document.getElementById('historyContent').insertBefore(confirmDiv, document.querySelector('.history-table'));
        }

        async function confirmDelete(backendId) {
            if (!window.dataSdk) return;
            
            const record = allData.find(r => r.__backendId === backendId);
            if (!record) return;
            
            const result = await window.dataSdk.delete(record);
            
            // Remove confirmation dialog
            const confirmDiv = document.querySelector('[style*="rgba(255, 71, 87, 0.1)"]');
            if (confirmDiv) confirmDiv.remove();
            
            if (result.isOk) {
                // Show success message
                const successDiv = document.createElement('div');
                successDiv.style.cssText = 'background: #2ed573; color: white; padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center;';
                successDiv.textContent = 'Data berhasil dihapus!';
                document.getElementById('historyContent').insertBefore(successDiv, document.querySelector('.history-table'));
                
                setTimeout(() => successDiv.remove(), 3000);
            } else {
                // Show error message
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'background: #ff4757; color: white; padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center;';
                errorDiv.textContent = 'Gagal menghapus data. Silakan coba lagi.';
                document.getElementById('historyContent').insertBefore(errorDiv, document.querySelector('.history-table'));
                
                setTimeout(() => errorDiv.remove(), 5000);
            }
        }

        function editRecord(backendId) {
            // For demo purposes, show a message that edit functionality would be implemented
            const infoDiv = document.createElement('div');
            infoDiv.style.cssText = 'background: #ffa502; color: white; padding: 15px; border-radius: 10px; margin: 20px 0; text-align: center;';
            infoDiv.textContent = 'Fitur edit akan segera tersedia dalam versi selanjutnya.';
            document.getElementById('historyContent').insertBefore(infoDiv, document.querySelector('.history-table'));
            
            setTimeout(() => infoDiv.remove(), 3000);
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995ac3c203009ca5',t:'MTc2MTY1Nzk4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
